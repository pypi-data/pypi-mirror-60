{"version":3,"file":"spinner.js","sources":["../../node_modules/@wq/app/src/spinner.js"],"sourcesContent":["var jqm;\n\nconst SPIN_START = 'SPIN_START';\nconst SPIN_STOP = 'SPIN_STOP';\n\nasync function startSpin(dispatch, getState, bag) {\n    const { action } = bag,\n        { duration } = action.payload;\n\n    if (duration) {\n        await new Promise(resolve => setTimeout(resolve, duration * 1000));\n        dispatch({ type: SPIN_STOP });\n    }\n}\n\nfunction reducer(context = {}, action) {\n    if (action.type === SPIN_START) {\n        context = {\n            active: true,\n            ...action.payload\n        };\n    } else if (action.type === SPIN_STOP) {\n        context = {};\n    }\n    return context;\n}\n\nfunction render(state) {\n    if (!jqm) {\n        return;\n    }\n    if (state.spinner && state.spinner.active) {\n        var { options: opts, message: msg } = state.spinner;\n\n        if (!opts) {\n            opts = {};\n        }\n        if (msg) {\n            opts.text = msg;\n            opts.textVisible = true;\n        }\n        jqm.loading('show', opts);\n    } else {\n        jqm.loading('hide');\n    }\n}\n\nexport default {\n    name: 'spinner',\n    init: function() {\n        jqm = this.app.jQuery && this.app.jQuery.mobile;\n    },\n    actions: {\n        start: (msg, duration, opts) => ({\n            type: SPIN_START,\n            payload: {\n                message: msg,\n                duration: duration,\n                opts: opts\n            }\n        }),\n        stop: () => ({ type: SPIN_STOP })\n    },\n    thunks: {\n        SPIN_START: startSpin\n    },\n    reducer: reducer,\n    render: render\n};\n"],"names":["jqm","SPIN_START","SPIN_STOP","startSpin","dispatch","getState","bag","action","duration","payload","Promise","resolve","setTimeout","type","reducer","context","active","render","state","spinner","opts","options","msg","message","text","textVisible","loading","name","init","app","jQuery","mobile","actions","start","stop","thunks"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAIA,GAAJ;AAEA,IAAMC,UAAU,GAAG,YAAnB;AACA,IAAMC,SAAS,GAAG,WAAlB;;SAEeC;;;;;;;6BAAf,iBAAyBC,QAAzB,EAAmCC,QAAnC,EAA6CC,GAA7C;;;;;;wBACYC,MADZ,GACuBD,GADvB,CACYC,MADZ,EAEUC,QAFV,GAEuBD,MAAM,CAACE,OAF9B,CAEUD,QAFV;;6BAIQA,QAJR;;;;;;+BAKc,IAAIE,OAAJ,CAAY,UAAAC,OAAO;mCAAIC,UAAU,CAACD,OAAD,EAAUH,QAAQ,GAAG,IAArB,CAAd;yBAAnB,CALd;;;wBAMQJ,QAAQ,CAAC;4BAAES,IAAI,EAAEX;yBAAT,CAAR;;;;;;;;;;;;AAIR,SAASY,OAAT,GAAuC;QAAtBC,OAAsB,uEAAZ,EAAY;QAARR,MAAQ;;QAC/BA,MAAM,CAACM,IAAP,KAAgBZ,UAApB,EAAgC;QAC5Bc,OAAO;YACHC,MAAM,EAAE;WACLT,MAAM,CAACE,OAFP,CAAP;KADJ,MAKO,IAAIF,MAAM,CAACM,IAAP,KAAgBX,SAApB,EAA+B;QAClCa,OAAO,GAAG,EAAV;;;WAEGA,OAAP;;;AAGJ,SAASE,MAAT,CAAgBC,KAAhB,EAAuB;QACf,CAAClB,GAAL,EAAU;;;;QAGNkB,KAAK,CAACC,OAAN,IAAiBD,KAAK,CAACC,OAAN,CAAcH,MAAnC,EAA2C;6BACDE,KAAK,CAACC,OADL;YACxBC,IADwB,kBACjCC,OADiC;YACTC,GADS,kBAClBC,OADkB;;YAGnC,CAACH,IAAL,EAAW;YACPA,IAAI,GAAG,EAAP;;;YAEAE,GAAJ,EAAS;YACLF,IAAI,CAACI,IAAL,GAAYF,GAAZ;YACAF,IAAI,CAACK,WAAL,GAAmB,IAAnB;;;QAEJzB,GAAG,CAAC0B,OAAJ,CAAY,MAAZ,EAAoBN,IAApB;KAVJ,MAWO;QACHpB,GAAG,CAAC0B,OAAJ,CAAY,MAAZ;;;;AAIR,cAAe;IACXC,IAAI,EAAE,SADK;IAEXC,IAAI,EAAE,gBAAW;QACb5B,GAAG,GAAG,KAAK6B,GAAL,CAASC,MAAT,IAAmB,KAAKD,GAAL,CAASC,MAAT,CAAgBC,MAAzC;KAHO;IAKXC,OAAO,EAAE;QACLC,KAAK,EAAE,eAACX,GAAD,EAAMd,QAAN,EAAgBY,IAAhB;mBAA0B;gBAC7BP,IAAI,EAAEZ,UADuB;gBAE7BQ,OAAO,EAAE;oBACLc,OAAO,EAAED,GADJ;oBAELd,QAAQ,EAAEA,QAFL;oBAGLY,IAAI,EAAEA;;aALP;SADF;QASLc,IAAI,EAAE;mBAAO;gBAAErB,IAAI,EAAEX;aAAf;;KAdC;IAgBXiC,MAAM,EAAE;QACJlC,UAAU,EAAEE;KAjBL;IAmBXW,OAAO,EAAEA,OAnBE;IAoBXG,MAAM,EAAEA;CApBZ;;;;;;;;"}