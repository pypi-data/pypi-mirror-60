{"version":3,"sources":["webpack:///./src/components/ha-fab.ts","webpack:///./src/components/ha-icon-next.ts","webpack:///./src/util/toast-saved-success.ts","webpack:///./src/data/user.ts","webpack:///./src/panels/config/users/ha-config-user-picker.js","webpack:///./src/panels/config/users/ha-user-editor.ts","webpack:///./src/panels/config/users/ha-config-users.js"],"names":["MwcFab","customElements","get","_decorate","customElement","_initialize","_MwcFab","F","_MwcFab2","HaFab","_getPrototypeOf2","_this","_classCallCheck","this","_len","arguments","length","args","Array","_key","_getPrototypeOf","call","apply","concat","_assertThisInitialized","_inherits","d","kind","key","value","classes","mdc-fab--mini","mini","mdc-fab--exited","exited","mdc-fab--extended","extended","showLabel","label","html","_templateObject","ripple","classMap","disabled","icon","showIconAtEnd","_templateObject2","HaIconNext","_HaIcon","_possibleConstructorReturn","HaIcon","_get","prototype","setTimeout","window","getComputedStyle","direction","define","__webpack_require__","__webpack_exports__","showSaveSuccessToast","_toast__WEBPACK_IMPORTED_MODULE_0__","el","hass","showToast","message","localize","SYSTEM_GROUP_ID_ADMIN","SYSTEM_GROUP_ID_USER","fetchUsers","updateUser","deleteUser","regeneratorRuntime","async","_context","prev","next","abrupt","callWS","type","stop","userId","params","_context3","Object","assign","user_id","_context4","registeredDialog","HaUserPicker","EventsMixin","NavigateMixin","LocalizeMixin","PolymerElement","users","rtl","Boolean","reflectToAttribute","computed","fire","dialogShowEvent","dialogTag","dialogImport","Promise","all","e","then","bind","defaultValue","user","id","group_ids","computeRTL","dialogClosedCallback","_ref","navigate","GROUPS","property","_name","is_owner","_handleGroupChange","until","updateComplete","map","groupId","_templateObject3","_templateObject4","is_active","system_generated","_handleRenameUser","_deleteUser","_templateObject5","ha_user_editor_templateObject","name","ev","newName","currentTarget","blur","prompt","awrap","fireEvent","t0","alert","selectEl","newGroup","_context2","confirm","target","code","haStyle","css","_templateObject6","LitElement","HaConfigUsers","ha_config_users_templateObject","route","observer","_routeData","_user","_users","ha_config_users_get","ha_config_users_getPrototypeOf","_loadData","addEventListener","detail","_this2","_debouncer","Debouncer","debounce","timeOut","after","path","prefix","filter","u","a","b"],"mappings":"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","file":"chunk.eea998293a6a7d976c60.js","sourcesContent":["import { classMap } from \"lit-html/directives/class-map\";\nimport { html, customElement } from \"lit-element\";\nimport { ripple } from \"@material/mwc-ripple/ripple-directive.js\";\n\nimport \"@material/mwc-fab\";\nimport { Constructor } from \"../types\";\n// tslint:disable-next-line\nimport { Fab } from \"@material/mwc-fab\";\n// tslint:disable-next-line\nconst MwcFab = customElements.get(\"mwc-fab\") as Constructor<Fab>;\n\n@customElement(\"ha-fab\")\nexport class HaFab extends MwcFab {\n  // We override the render method because we don't have an icon font and mwc-fab doesn't support our svg-icon sets.\n  // Based on version mwc-fab 0.8\n  protected render() {\n    const classes = {\n      \"mdc-fab--mini\": this.mini,\n      \"mdc-fab--exited\": this.exited,\n      \"mdc-fab--extended\": this.extended,\n    };\n    const showLabel = this.label !== \"\" && this.extended;\n    return html`\n      <button\n        .ripple=\"${ripple()}\"\n        class=\"mdc-fab ${classMap(classes)}\"\n        ?disabled=\"${this.disabled}\"\n        aria-label=\"${this.label || this.icon}\"\n      >\n        ${showLabel && this.showIconAtEnd ? this.label : \"\"}\n        ${this.icon\n          ? html`\n              <ha-icon .icon=${this.icon}></ha-icon>\n            `\n          : \"\"}\n        ${showLabel && !this.showIconAtEnd ? this.label : \"\"}\n      </button>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-fab\": HaFab;\n  }\n}\n","import \"@polymer/iron-icon/iron-icon\";\n// Not duplicate, this is for typing.\n// tslint:disable-next-line\nimport { HaIcon } from \"./ha-icon\";\n\nexport class HaIconNext extends HaIcon {\n  public connectedCallback() {\n    super.connectedCallback();\n\n    // wait to check for direction since otherwise direction is wrong even though top level is RTL\n    setTimeout(() => {\n      this.icon =\n        window.getComputedStyle(this).direction === \"ltr\"\n          ? \"hass:chevron-right\"\n          : \"hass:chevron-left\";\n    }, 100);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-icon-next\": HaIconNext;\n  }\n}\n\ncustomElements.define(\"ha-icon-next\", HaIconNext);\n","import { showToast } from \"./toast\";\nimport { HomeAssistant } from \"../types\";\n\nexport const showSaveSuccessToast = (el: HTMLElement, hass: HomeAssistant) =>\n  showToast(el, {\n    message: hass!.localize(\"ui.common.successfully_saved\"),\n  });\n","import { HomeAssistant } from \"../types\";\nimport { Credential } from \"./auth\";\n\nexport const SYSTEM_GROUP_ID_ADMIN = \"system-admin\";\nexport const SYSTEM_GROUP_ID_USER = \"system-users\";\nexport const SYSTEM_GROUP_ID_READ_ONLY = \"system-read-only\";\n\nexport interface User {\n  id: string;\n  name: string;\n  is_owner: boolean;\n  is_active: boolean;\n  system_generated: boolean;\n  group_ids: string[];\n  credentials: Credential[];\n}\n\ninterface UpdateUserParams {\n  name?: User[\"name\"];\n  group_ids?: User[\"group_ids\"];\n}\n\nexport const fetchUsers = async (hass: HomeAssistant) =>\n  hass.callWS<User[]>({\n    type: \"config/auth/list\",\n  });\n\nexport const createUser = async (hass: HomeAssistant, name: string) =>\n  hass.callWS<{ user: User }>({\n    type: \"config/auth/create\",\n    name,\n  });\n\nexport const updateUser = async (\n  hass: HomeAssistant,\n  userId: string,\n  params: UpdateUserParams\n) =>\n  hass.callWS<{ user: User }>({\n    ...params,\n    type: \"config/auth/update\",\n    user_id: userId,\n  });\n\nexport const deleteUser = async (hass: HomeAssistant, userId: string) =>\n  hass.callWS<void>({\n    type: \"config/auth/delete\",\n    user_id: userId,\n  });\n","import \"@polymer/paper-item/paper-item\";\nimport \"@polymer/paper-item/paper-item-body\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../layouts/hass-subpage\";\nimport \"../../../components/ha-icon-next\";\nimport \"../../../components/ha-card\";\nimport \"../../../components/ha-fab\";\n\nimport LocalizeMixin from \"../../../mixins/localize-mixin\";\nimport NavigateMixin from \"../../../mixins/navigate-mixin\";\nimport { EventsMixin } from \"../../../mixins/events-mixin\";\n\nimport { computeRTL } from \"../../../common/util/compute_rtl\";\n\nlet registeredDialog = false;\n\n/*\n * @appliesMixin LocalizeMixin\n * @appliesMixin NavigateMixin\n * @appliesMixin EventsMixin\n */\nclass HaUserPicker extends EventsMixin(\n  NavigateMixin(LocalizeMixin(PolymerElement))\n) {\n  static get template() {\n    return html`\n      <style>\n        ha-fab {\n          position: fixed;\n          bottom: 16px;\n          right: 16px;\n          z-index: 1;\n        }\n        ha-fab[is-wide] {\n          bottom: 24px;\n          right: 24px;\n        }\n        ha-fab[rtl] {\n          right: auto;\n          left: 16px;\n        }\n        ha-fab[rtl][is-wide] {\n          bottom: 24px;\n          right: auto;\n          left: 24px;\n        }\n\n        ha-card {\n          max-width: 600px;\n          margin: 16px auto;\n          overflow: hidden;\n        }\n        a {\n          text-decoration: none;\n          color: var(--primary-text-color);\n        }\n      </style>\n\n      <hass-subpage header=\"[[localize('ui.panel.config.users.picker.title')]]\">\n        <ha-card>\n          <template is=\"dom-repeat\" items=\"[[users]]\" as=\"user\">\n            <a href=\"[[_computeUrl(user)]]\">\n              <paper-item>\n                <paper-item-body two-line>\n                  <div>[[_withDefault(user.name, 'Unnamed User')]]</div>\n                  <div secondary=\"\">\n                    [[_computeGroup(localize, user)]]\n                    <template is=\"dom-if\" if=\"[[user.system_generated]]\">\n                      -\n                      [[localize('ui.panel.config.users.picker.system_generated')]]\n                    </template>\n                  </div>\n                </paper-item-body>\n                <ha-icon-next></ha-icon-next>\n              </paper-item>\n            </a>\n          </template>\n        </ha-card>\n\n        <ha-fab\n          is-wide$=\"[[isWide]]\"\n          icon=\"hass:plus\"\n          title=\"[[localize('ui.panel.config.users.picker.add_user')]]\"\n          on-click=\"_addUser\"\n          rtl$=\"[[rtl]]\"\n        ></ha-fab>\n      </hass-subpage>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      users: Array,\n\n      rtl: {\n        type: Boolean,\n        reflectToAttribute: true,\n        computed: \"_computeRTL(hass)\",\n      },\n    };\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    if (!registeredDialog) {\n      registeredDialog = true;\n      this.fire(\"register-dialog\", {\n        dialogShowEvent: \"show-add-user\",\n        dialogTag: \"ha-dialog-add-user\",\n        dialogImport: () =>\n          import(/* webpackChunkName: \"ha-dialog-add-user\" */ \"./ha-dialog-add-user\"),\n      });\n    }\n  }\n\n  _withDefault(value, defaultValue) {\n    return value || defaultValue;\n  }\n\n  _computeUrl(user) {\n    return `/config/users/${user.id}`;\n  }\n\n  _computeGroup(localize, user) {\n    return localize(`groups.${user.group_ids[0]}`);\n  }\n\n  _computeRTL(hass) {\n    return computeRTL(hass);\n  }\n\n  _addUser() {\n    this.fire(\"show-add-user\", {\n      hass: this.hass,\n      dialogClosedCallback: async ({ userId }) => {\n        this.fire(\"reload-users\");\n        if (userId) this.navigate(`/config/users/${userId}`);\n      },\n    });\n  }\n}\n\ncustomElements.define(\"ha-config-user-picker\", HaUserPicker);\n","import {\n  LitElement,\n  TemplateResult,\n  html,\n  customElement,\n  CSSResultArray,\n  css,\n  property,\n} from \"lit-element\";\nimport { until } from \"lit-html/directives/until\";\nimport \"@material/mwc-button\";\n\nimport \"../../../layouts/hass-subpage\";\nimport { haStyle } from \"../../../resources/styles\";\nimport \"../../../components/ha-card\";\nimport { HomeAssistant } from \"../../../types\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { navigate } from \"../../../common/navigate\";\nimport {\n  User,\n  deleteUser,\n  updateUser,\n  SYSTEM_GROUP_ID_USER,\n  SYSTEM_GROUP_ID_ADMIN,\n} from \"../../../data/user\";\nimport { showSaveSuccessToast } from \"../../../util/toast-saved-success\";\n\ndeclare global {\n  interface HASSDomEvents {\n    \"reload-users\": undefined;\n  }\n}\n\nconst GROUPS = [SYSTEM_GROUP_ID_USER, SYSTEM_GROUP_ID_ADMIN];\n\n@customElement(\"ha-user-editor\")\nclass HaUserEditor extends LitElement {\n  @property() public hass?: HomeAssistant;\n  @property() public user?: User;\n\n  protected render(): TemplateResult | void {\n    const hass = this.hass;\n    const user = this.user;\n    if (!hass || !user) {\n      return html``;\n    }\n\n    return html`\n      <hass-subpage\n        .header=${hass.localize(\"ui.panel.config.users.editor.caption\")}\n      >\n        <ha-card .header=${this._name}>\n          <table class=\"card-content\">\n            <tr>\n              <td>${hass.localize(\"ui.panel.config.users.editor.id\")}</td>\n              <td>${user.id}</td>\n            </tr>\n            <tr>\n              <td>${hass.localize(\"ui.panel.config.users.editor.owner\")}</td>\n              <td>${user.is_owner}</td>\n            </tr>\n            <tr>\n              <td>${hass.localize(\"ui.panel.config.users.editor.group\")}</td>\n              <td>\n                <select\n                  @change=${this._handleGroupChange}\n                  .value=${until(\n                    this.updateComplete.then(() => user.group_ids[0])\n                  )}\n                >\n                  ${GROUPS.map(\n                    (groupId) => html`\n                      <option value=${groupId}>\n                        ${hass.localize(`groups.${groupId}`)}\n                      </option>\n                    `\n                  )}\n                </select>\n              </td>\n            </tr>\n            ${user.group_ids[0] === SYSTEM_GROUP_ID_USER\n              ? html`\n                  <tr>\n                    <td colspan=\"2\" class=\"user-experiment\">\n                      The users group is a work in progress. The user will be\n                      unable to administer the instance via the UI. We're still\n                      auditing all management API endpoints to ensure that they\n                      correctly limit access to administrators.\n                    </td>\n                  </tr>\n                `\n              : \"\"}\n\n            <tr>\n              <td>${hass.localize(\"ui.panel.config.users.editor.active\")}</td>\n              <td>${user.is_active}</td>\n            </tr>\n            <tr>\n              <td>\n                ${hass.localize(\n                  \"ui.panel.config.users.editor.system_generated\"\n                )}\n              </td>\n              <td>${user.system_generated}</td>\n            </tr>\n          </table>\n\n          <div class=\"card-actions\">\n            <mwc-button @click=${this._handleRenameUser}>\n              ${hass.localize(\"ui.panel.config.users.editor.rename_user\")}\n            </mwc-button>\n            <mwc-button\n              class=\"warning\"\n              @click=${this._deleteUser}\n              .disabled=${user.system_generated}\n            >\n              ${hass.localize(\"ui.panel.config.users.editor.delete_user\")}\n            </mwc-button>\n            ${user.system_generated\n              ? html`\n                  ${hass.localize(\n                    \"ui.panel.config.users.editor.system_generated_users_not_removable\"\n                  )}\n                `\n              : \"\"}\n          </div>\n        </ha-card>\n      </hass-subpage>\n    `;\n  }\n\n  private get _name() {\n    return (\n      this.user &&\n      (this.user.name ||\n        this.hass!.localize(\"ui.panel.config.users.editor.unnamed_user\"))\n    );\n  }\n\n  private async _handleRenameUser(ev): Promise<void> {\n    ev.currentTarget.blur();\n    const newName = prompt(\n      this.hass!.localize(\"ui.panel.config.users.editor.enter_new_name\"),\n      this.user!.name\n    );\n    if (newName === null || newName === this.user!.name) {\n      return;\n    }\n\n    try {\n      await updateUser(this.hass!, this.user!.id, {\n        name: newName,\n      });\n      fireEvent(this, \"reload-users\");\n    } catch (err) {\n      alert(\n        `${this.hass!.localize(\n          \"ui.panel.config.users.editor.user_rename_failed\"\n        )} ${err.message}`\n      );\n    }\n  }\n\n  private async _handleGroupChange(ev): Promise<void> {\n    const selectEl = ev.currentTarget as HTMLSelectElement;\n    const newGroup = selectEl.value;\n    try {\n      await updateUser(this.hass!, this.user!.id, {\n        group_ids: [newGroup],\n      });\n      showSaveSuccessToast(this, this.hass!);\n      fireEvent(this, \"reload-users\");\n    } catch (err) {\n      alert(\n        `${this.hass!.localize(\n          \"ui.panel.config.users.editor.group_update_failed\"\n        )} ${err.message}`\n      );\n      selectEl.value = this.user!.group_ids[0];\n    }\n  }\n\n  private async _deleteUser(ev): Promise<void> {\n    if (\n      !confirm(\n        this.hass!.localize(\n          \"ui.panel.config.users.editor.confirm_user_deletion\",\n          \"name\",\n          this._name\n        )\n      )\n    ) {\n      ev.target.blur();\n      return;\n    }\n    try {\n      await deleteUser(this.hass!, this.user!.id);\n    } catch (err) {\n      alert(err.code);\n      return;\n    }\n    fireEvent(this, \"reload-users\");\n    navigate(this, \"/config/users\");\n  }\n\n  static get styles(): CSSResultArray {\n    return [\n      haStyle,\n      css`\n        .card-actions {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n        }\n        ha-card {\n          max-width: 600px;\n          margin: 0 auto 16px;\n        }\n        hass-subpage ha-card:first-of-type {\n          direction: ltr;\n        }\n        table {\n          width: 100%;\n        }\n        td {\n          vertical-align: top;\n        }\n        .user-experiment {\n          padding: 8px 0;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-user-editor\": HaUserEditor;\n  }\n}\n","import \"@polymer/app-route/app-route\";\nimport { timeOut } from \"@polymer/polymer/lib/utils/async\";\nimport { Debouncer } from \"@polymer/polymer/lib/utils/debounce\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport NavigateMixin from \"../../../mixins/navigate-mixin\";\n\nimport \"./ha-config-user-picker\";\nimport \"./ha-user-editor\";\nimport { fireEvent } from \"../../../common/dom/fire_event\";\nimport { fetchUsers } from \"../../../data/user\";\n\n/*\n * @appliesMixin NavigateMixin\n */\nclass HaConfigUsers extends NavigateMixin(PolymerElement) {\n  static get template() {\n    return html`\n      <app-route\n        route=\"[[route]]\"\n        pattern=\"/:user\"\n        data=\"{{_routeData}}\"\n      ></app-route>\n\n      <template is=\"dom-if\" if='[[_equals(_routeData.user, \"picker\")]]'>\n        <ha-config-user-picker\n          hass=\"[[hass]]\"\n          users=\"[[_users]]\"\n        ></ha-config-user-picker>\n      </template>\n      <template\n        is=\"dom-if\"\n        if='[[!_equals(_routeData.user, \"picker\")]]'\n        restamp\n      >\n        <ha-user-editor\n          hass=\"[[hass]]\"\n          user=\"[[_computeUser(_users, _routeData.user)]]\"\n        ></ha-user-editor>\n      </template>\n    `;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      route: {\n        type: Object,\n        observer: \"_checkRoute\",\n      },\n      _routeData: Object,\n      _user: {\n        type: Object,\n        value: null,\n      },\n      _users: {\n        type: Array,\n        value: null,\n      },\n    };\n  }\n\n  ready() {\n    super.ready();\n    this._loadData();\n    this.addEventListener(\"reload-users\", () => this._loadData());\n  }\n\n  _handlePickUser(ev) {\n    this._user = ev.detail.user;\n  }\n\n  _checkRoute(route) {\n    // prevent list getting under toolbar\n    fireEvent(this, \"iron-resize\");\n\n    this._debouncer = Debouncer.debounce(\n      this._debouncer,\n      timeOut.after(0),\n      () => {\n        if (route.path === \"\") {\n          this.navigate(`${route.prefix}/picker`, true);\n        }\n      }\n    );\n  }\n\n  _computeUser(users, userId) {\n    return users && users.filter((u) => u.id === userId)[0];\n  }\n\n  _equals(a, b) {\n    return a === b;\n  }\n\n  async _loadData() {\n    this._users = await fetchUsers(this.hass);\n  }\n}\n\ncustomElements.define(\"ha-config-users\", HaConfigUsers);\n"],"sourceRoot":""}