{"version":3,"sources":["webpack:///./src/components/ha-switch.ts","webpack:///./src/common/util/render-status.ts","webpack:///./src/components/map/ha-location-editor.ts","webpack:///./src/components/ha-dialog.ts","webpack:///./src/panels/config/zone/dialog-zone-detail.ts","webpack:///./src/common/location/add_distance_to_coord.ts"],"names":["MwcSwitch","customElements","get","_decorate","customElement","_initialize","_MwcSwitch","HaSwitch","_MwcSwitch2","_getPrototypeOf2","_this","_classCallCheck","this","_len","arguments","length","args","Array","_key","_getPrototypeOf","call","apply","concat","_assertThisInitialized","_inherits","F","d","kind","decorators","query","key","value","_this2","_get","prototype","style","setProperty","classList","toggle","Boolean","_slot","assignedNodes","addEventListener","checked","static","css","_templateObject","__webpack_require__","__webpack_exports__","afterNextRender","nextRender","cb","requestAnimationFrame","setTimeout","Promise","resolve","LocationEditor","property","_leafletMap","location","_locationMarker","getBounds","fitBounds","setView","fitZoom","_ignoreFitToMap","html","changedProps","_initMap","Leaflet","has","_updateMarker","fitMap","_updateRadius","_updateIcon","shadowRoot","querySelector","_ref","_ref2","regeneratorRuntime","async","_context","prev","next","awrap","setupLeafletMap","_mapEl","radius","sent","_slicedToArray","ev","_locationUpdated","latlng","invalidateSize","stop","longitude","lng","Math","abs","lat","fireEvent","undefined","bubbles","getRadius","icon","iconHTML","el","document","createElement","setAttribute","outerHTML","_iconEl","divIcon","iconSize","className","_setIcon","editing","_moveMarker","setIcon","_this3","enable","moveMarker","resizeMarker","_resizeMarkers","target","getLatLng","_radiusUpdated","_this4","_context2","remove","abrupt","setLatLng","disable","_setupEdit","circle","color","addLayer","marker","draggable","setRadius","_templateObject2","LitElement","MwcDialog","_MwcDialog","_MwcDialog2","HaDialog","DialogZoneDetail","params","movedHomeLocation","_params","_error","entry","_name","name","_icon","_latitude","latitude","hass","config","_longitude","_passive","passive","_radius","dx","dy","PI","cos","updateComplete","title","localize","nameValid","trim","iconValid","includes","latValid","String","lngValid","radiusValid","valid","_templateObject3","_close","_templateObject4","_valueChanged","_locationValue","_locationChanged","_passiveChanged","_templateObject5","_deleteEntry","_submitting","_templateObject6","_updateEntry","Number","_ev$currentTarget$loc","currentTarget","configValue","detail","values","updateEntry","createEntry","t0","message","finish","_context3","removeEntry","_templateObject7","define"],"mappings":"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","file":"chunk.9044152dba13dbfd388b.js","sourcesContent":["import { customElement, CSSResult, css, query } from \"lit-element\";\nimport \"@material/mwc-switch\";\nimport { style } from \"@material/mwc-switch/mwc-switch-css\";\n// tslint:disable-next-line\nimport { Switch } from \"@material/mwc-switch\";\nimport { Constructor } from \"../types\";\n// tslint:disable-next-line\nconst MwcSwitch = customElements.get(\"mwc-switch\") as Constructor<Switch>;\n\n@customElement(\"ha-switch\")\nexport class HaSwitch extends MwcSwitch {\n  @query(\"slot\") private _slot!: HTMLSlotElement;\n\n  protected firstUpdated() {\n    super.firstUpdated();\n    this.style.setProperty(\n      \"--mdc-theme-secondary\",\n      \"var(--switch-checked-color)\"\n    );\n    this.classList.toggle(\n      \"slotted\",\n      Boolean(this._slot.assignedNodes().length)\n    );\n    this._slot.addEventListener(\"click\", () => (this.checked = !this.checked));\n  }\n\n  protected static get styles(): CSSResult[] {\n    return [\n      style,\n      css`\n        :host {\n          display: flex;\n          flex-direction: row;\n          align-items: center;\n        }\n        .mdc-switch.mdc-switch--checked .mdc-switch__thumb {\n          background-color: var(--switch-checked-button-color);\n          border-color: var(--switch-checked-button-color);\n        }\n        .mdc-switch.mdc-switch--checked .mdc-switch__track {\n          background-color: var(--switch-checked-track-color);\n          border-color: var(--switch-checked-track-color);\n        }\n        .mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb {\n          background-color: var(--switch-unchecked-button-color);\n          border-color: var(--switch-unchecked-button-color);\n        }\n        .mdc-switch:not(.mdc-switch--checked) .mdc-switch__track {\n          background-color: var(--switch-unchecked-track-color);\n          border-color: var(--switch-unchecked-track-color);\n        }\n        :host(.slotted) .mdc-switch {\n          margin-right: 24px;\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-switch\": HaSwitch;\n  }\n}\n","export const afterNextRender = (cb: () => void): void => {\n  requestAnimationFrame(() => setTimeout(cb, 0));\n};\n\nexport const nextRender = () => {\n  return new Promise((resolve) => {\n    afterNextRender(resolve);\n  });\n};\n","import {\n  LitElement,\n  property,\n  TemplateResult,\n  html,\n  CSSResult,\n  css,\n  customElement,\n  PropertyValues,\n} from \"lit-element\";\nimport {\n  Marker,\n  Map,\n  LeafletMouseEvent,\n  DragEndEvent,\n  LatLng,\n  Circle,\n  DivIcon,\n} from \"leaflet\";\nimport {\n  setupLeafletMap,\n  LeafletModuleType,\n} from \"../../common/dom/setup-leaflet-map\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { nextRender } from \"../../common/util/render-status\";\n\n@customElement(\"ha-location-editor\")\nclass LocationEditor extends LitElement {\n  @property() public location?: [number, number];\n  @property() public radius?: number;\n  @property() public icon?: string;\n  public fitZoom = 16;\n  private _iconEl?: DivIcon;\n  private _ignoreFitToMap?: [number, number];\n\n  // tslint:disable-next-line\n  private Leaflet?: LeafletModuleType;\n  private _leafletMap?: Map;\n  private _locationMarker?: Marker | Circle;\n\n  public fitMap(): void {\n    if (!this._leafletMap || !this.location) {\n      return;\n    }\n    if ((this._locationMarker as Circle).getBounds) {\n      this._leafletMap.fitBounds((this._locationMarker as Circle).getBounds());\n    } else {\n      this._leafletMap.setView(this.location, this.fitZoom);\n    }\n    this._ignoreFitToMap = this.location;\n  }\n\n  protected render(): TemplateResult {\n    return html`\n      <div id=\"map\"></div>\n    `;\n  }\n\n  protected firstUpdated(changedProps: PropertyValues): void {\n    super.firstUpdated(changedProps);\n    this._initMap();\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n\n    // Still loading.\n    if (!this.Leaflet) {\n      return;\n    }\n\n    if (changedProps.has(\"location\")) {\n      this._updateMarker();\n      if (\n        this.location &&\n        (!this._ignoreFitToMap ||\n          this._ignoreFitToMap[0] !== this.location[0] ||\n          this._ignoreFitToMap[1] !== this.location[1])\n      ) {\n        this.fitMap();\n      }\n    }\n    if (changedProps.has(\"radius\")) {\n      this._updateRadius();\n    }\n    if (changedProps.has(\"icon\")) {\n      this._updateIcon();\n    }\n  }\n\n  private get _mapEl(): HTMLDivElement {\n    return this.shadowRoot!.querySelector(\"div\")!;\n  }\n\n  private async _initMap(): Promise<void> {\n    [this._leafletMap, this.Leaflet] = await setupLeafletMap(\n      this._mapEl,\n      false,\n      Boolean(this.radius)\n    );\n    this._leafletMap.addEventListener(\n      \"click\",\n      // @ts-ignore\n      (ev: LeafletMouseEvent) => this._locationUpdated(ev.latlng)\n    );\n    this._updateIcon();\n    this._updateMarker();\n    this.fitMap();\n    this._leafletMap.invalidateSize();\n  }\n\n  private _locationUpdated(latlng: LatLng) {\n    let longitude = latlng.lng;\n    if (Math.abs(longitude) > 180.0) {\n      // Normalize longitude if map provides values beyond -180 to +180 degrees.\n      longitude = (((longitude % 360.0) + 540.0) % 360.0) - 180.0;\n    }\n    this.location = this._ignoreFitToMap = [latlng.lat, longitude];\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _radiusUpdated() {\n    this._ignoreFitToMap = this.location;\n    this.radius = (this._locationMarker as Circle).getRadius();\n    fireEvent(this, \"change\", undefined, { bubbles: false });\n  }\n\n  private _updateIcon() {\n    if (!this.icon) {\n      this._iconEl = undefined;\n      return;\n    }\n\n    // create icon\n    let iconHTML = \"\";\n    const el = document.createElement(\"ha-icon\");\n    el.setAttribute(\"icon\", this.icon);\n    iconHTML = el.outerHTML;\n\n    this._iconEl = this.Leaflet!.divIcon({\n      html: iconHTML,\n      iconSize: [24, 24],\n      className: \"light leaflet-edit-move\",\n    });\n    this._setIcon();\n  }\n\n  private _setIcon() {\n    if (!this._locationMarker || !this._iconEl) {\n      return;\n    }\n\n    if (!this.radius) {\n      (this._locationMarker as Marker).setIcon(this._iconEl);\n      return;\n    }\n\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    moveMarker.setIcon(this._iconEl);\n  }\n\n  private _setupEdit() {\n    // @ts-ignore\n    this._locationMarker.editing.enable();\n    // @ts-ignore\n    const moveMarker = this._locationMarker.editing._moveMarker;\n    // @ts-ignore\n    const resizeMarker = this._locationMarker.editing._resizeMarkers[0];\n    this._setIcon();\n    moveMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n    );\n    resizeMarker.addEventListener(\n      \"dragend\",\n      // @ts-ignore\n      (ev: DragEndEvent) => this._radiusUpdated(ev)\n    );\n  }\n\n  private async _updateMarker(): Promise<void> {\n    if (!this.location) {\n      if (this._locationMarker) {\n        this._locationMarker.remove();\n        this._locationMarker = undefined;\n      }\n      return;\n    }\n\n    if (this._locationMarker) {\n      this._locationMarker.setLatLng(this.location);\n      if (this.radius) {\n        // @ts-ignore\n        this._locationMarker.editing.disable();\n        await nextRender();\n        this._setupEdit();\n      }\n      return;\n    }\n\n    if (!this.radius) {\n      this._locationMarker = this.Leaflet!.marker(this.location, {\n        draggable: true,\n      });\n      this._setIcon();\n      this._locationMarker.addEventListener(\n        \"dragend\",\n        // @ts-ignore\n        (ev: DragEndEvent) => this._locationUpdated(ev.target.getLatLng())\n      );\n      this._leafletMap!.addLayer(this._locationMarker);\n    } else {\n      this._locationMarker = this.Leaflet!.circle(this.location, {\n        color: \"#FF9800\",\n        radius: this.radius,\n      });\n      this._leafletMap!.addLayer(this._locationMarker);\n      this._setupEdit();\n    }\n  }\n\n  private _updateRadius(): void {\n    if (!this._locationMarker || !this.radius) {\n      return;\n    }\n    (this._locationMarker as Circle).setRadius(this.radius);\n  }\n\n  static get styles(): CSSResult {\n    return css`\n      :host {\n        display: block;\n        height: 300px;\n      }\n      #map {\n        height: 100%;\n      }\n      .light {\n        color: #000000;\n      }\n      .leaflet-edit-move {\n        border-radius: 50%;\n        cursor: move !important;\n      }\n      .leaflet-edit-resize {\n        border-radius: 50%;\n        cursor: nesw-resize !important;\n      }\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-location-editor\": LocationEditor;\n  }\n}\n","import { customElement, CSSResult, css } from \"lit-element\";\nimport \"@material/mwc-dialog\";\nimport { style } from \"@material/mwc-dialog/mwc-dialog-css\";\n// tslint:disable-next-line\nimport { Dialog } from \"@material/mwc-dialog\";\nimport { Constructor } from \"../types\";\n// tslint:disable-next-line\nconst MwcDialog = customElements.get(\"mwc-dialog\") as Constructor<Dialog>;\n\n@customElement(\"ha-dialog\")\nexport class HaDialog extends MwcDialog {\n  protected static get styles(): CSSResult[] {\n    return [\n      style,\n      css`\n        .mdc-dialog__actions {\n          justify-content: var(--justify-action-buttons, flex-end);\n        }\n        .mdc-dialog__container {\n          align-items: var(--vertial-align-dialog, center);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-dialog\": HaDialog;\n  }\n}\n","import {\n  LitElement,\n  html,\n  css,\n  CSSResult,\n  TemplateResult,\n  property,\n} from \"lit-element\";\n\nimport \"@polymer/paper-input/paper-input\";\nimport \"@material/mwc-button\";\n\nimport \"../../../components/map/ha-location-editor\";\nimport \"../../../components/ha-switch\";\nimport \"../../../components/ha-dialog\";\n\nimport { ZoneDetailDialogParams } from \"./show-dialog-zone-detail\";\nimport { HomeAssistant } from \"../../../types\";\nimport { ZoneMutableParams } from \"../../../data/zone\";\nimport { addDistanceToCoord } from \"../../../common/location/add_distance_to_coord\";\n\nclass DialogZoneDetail extends LitElement {\n  @property() public hass!: HomeAssistant;\n  @property() private _name!: string;\n  @property() private _icon!: string;\n  @property() private _latitude!: number;\n  @property() private _longitude!: number;\n  @property() private _passive!: boolean;\n  @property() private _radius!: number;\n  @property() private _error?: string;\n  @property() private _params?: ZoneDetailDialogParams;\n  @property() private _submitting: boolean = false;\n\n  public async showDialog(params: ZoneDetailDialogParams): Promise<void> {\n    this._params = params;\n    this._error = undefined;\n    if (this._params.entry) {\n      this._name = this._params.entry.name || \"\";\n      this._icon = this._params.entry.icon || \"\";\n      this._latitude = this._params.entry.latitude || this.hass.config.latitude;\n      this._longitude =\n        this._params.entry.longitude || this.hass.config.longitude;\n      this._passive = this._params.entry.passive || false;\n      this._radius = this._params.entry.radius || 100;\n    } else {\n      const movedHomeLocation = addDistanceToCoord(\n        [this.hass.config.latitude, this.hass.config.longitude],\n        500,\n        500\n      );\n      this._name = \"\";\n      this._icon = \"mdi:map-marker\";\n      this._latitude = movedHomeLocation[0];\n      this._longitude = movedHomeLocation[1];\n      this._passive = false;\n      this._radius = 100;\n    }\n    await this.updateComplete;\n  }\n\n  protected render(): TemplateResult {\n    if (!this._params) {\n      return html``;\n    }\n    const title = html`\n      ${this._params.entry\n        ? this._params.entry.name\n        : this.hass!.localize(\"ui.panel.config.zone.detail.new_zone\")}\n      <paper-icon-button\n        aria-label=${this.hass.localize(\n          \"ui.panel.config.integrations.config_flow.dismiss\"\n        )}\n        icon=\"hass:close\"\n        dialogAction=\"close\"\n        style=\"position: absolute; right: 16px; top: 12px;\"\n      ></paper-icon-button>\n    `;\n    const nameValid = this._name.trim() === \"\";\n    const iconValid = !this._icon.trim().includes(\":\");\n    const latValid = String(this._latitude) === \"\";\n    const lngValid = String(this._longitude) === \"\";\n    const radiusValid = String(this._radius) === \"\";\n\n    const valid =\n      !nameValid && !iconValid && !latValid && !lngValid && !radiusValid;\n\n    return html`\n      <ha-dialog\n        open\n        @closing=\"${this._close}\"\n        scrimClickAction=\"\"\n        escapeKeyAction=\"\"\n        .title=${title}\n      >\n        <div>\n          ${this._error\n            ? html`\n                <div class=\"error\">${this._error}</div>\n              `\n            : \"\"}\n          <div class=\"form\">\n            <paper-input\n              .value=${this._name}\n              .configValue=${\"name\"}\n              @value-changed=${this._valueChanged}\n              .label=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.name\"\n              )}\"\n              .errorMessage=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.required_error_msg\"\n              )}\"\n              .invalid=${nameValid}\n            ></paper-input>\n            <paper-input\n              .value=${this._icon}\n              .configValue=${\"icon\"}\n              @value-changed=${this._valueChanged}\n              .label=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.icon\"\n              )}\"\n              .errorMessage=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.icon_error_msg\"\n              )}\"\n              .invalid=${iconValid}\n            ></paper-input>\n            <ha-location-editor\n              class=\"flex\"\n              .location=${this._locationValue}\n              .radius=${this._radius}\n              .icon=${this._icon}\n              @change=${this._locationChanged}\n            ></ha-location-editor>\n            <div class=\"location\">\n              <paper-input\n                .value=${this._latitude}\n                .configValue=${\"latitude\"}\n                @value-changed=${this._valueChanged}\n                .label=\"${this.hass!.localize(\n                  \"ui.panel.config.zone.detail.latitude\"\n                )}\"\n                .errorMessage=\"${this.hass!.localize(\n                  \"ui.panel.config.zone.detail.required_error_msg\"\n                )}\"\n                .invalid=${latValid}\n              ></paper-input>\n              <paper-input\n                .value=${this._longitude}\n                .configValue=${\"longitude\"}\n                @value-changed=${this._valueChanged}\n                .label=\"${this.hass!.localize(\n                  \"ui.panel.config.zone.detail.longitude\"\n                )}\"\n                .errorMessage=\"${this.hass!.localize(\n                  \"ui.panel.config.zone.detail.required_error_msg\"\n                )}\"\n                .invalid=${lngValid}\n              ></paper-input>\n            </div>\n            <paper-input\n              .value=${this._radius}\n              .configValue=${\"radius\"}\n              @value-changed=${this._valueChanged}\n              .label=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.radius\"\n              )}\"\n              .errorMessage=\"${this.hass!.localize(\n                \"ui.panel.config.zone.detail.required_error_msg\"\n              )}\"\n              .invalid=${radiusValid}\n            ></paper-input>\n            <p>\n              ${this.hass!.localize(\"ui.panel.config.zone.detail.passive_note\")}\n            </p>\n            <ha-switch .checked=${this._passive} @change=${this._passiveChanged}\n              >${this.hass!.localize(\n                \"ui.panel.config.zone.detail.passive\"\n              )}</ha-switch\n            >\n          </div>\n        </div>\n        ${this._params.entry\n          ? html`\n              <mwc-button\n                slot=\"secondaryAction\"\n                class=\"warning\"\n                @click=\"${this._deleteEntry}\"\n                .disabled=${this._submitting}\n              >\n                ${this.hass!.localize(\"ui.panel.config.zone.detail.delete\")}\n              </mwc-button>\n            `\n          : html``}\n        <mwc-button\n          slot=\"primaryAction\"\n          @click=\"${this._updateEntry}\"\n          .disabled=${!valid || this._submitting}\n        >\n          ${this._params.entry\n            ? this.hass!.localize(\"ui.panel.config.zone.detail.update\")\n            : this.hass!.localize(\"ui.panel.config.zone.detail.create\")}\n        </mwc-button>\n      </ha-dialog>\n    `;\n  }\n\n  private get _locationValue() {\n    return [Number(this._latitude), Number(this._longitude)];\n  }\n\n  private _locationChanged(ev) {\n    [this._latitude, this._longitude] = ev.currentTarget.location;\n    this._radius = ev.currentTarget.radius;\n  }\n\n  private _passiveChanged(ev) {\n    this._passive = ev.target.checked;\n  }\n\n  private _valueChanged(ev: CustomEvent) {\n    const configValue = (ev.target as any).configValue;\n\n    this._error = undefined;\n    this[`_${configValue}`] = ev.detail.value;\n  }\n\n  private async _updateEntry() {\n    this._submitting = true;\n    try {\n      const values: ZoneMutableParams = {\n        name: this._name.trim(),\n        icon: this._icon.trim(),\n        latitude: this._latitude,\n        longitude: this._longitude,\n        passive: this._passive,\n        radius: this._radius,\n      };\n      if (this._params!.entry) {\n        await this._params!.updateEntry!(values);\n      } else {\n        await this._params!.createEntry(values);\n      }\n      this._params = undefined;\n    } catch (err) {\n      this._error = err ? err.message : \"Unknown error\";\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private async _deleteEntry() {\n    this._submitting = true;\n    try {\n      if (await this._params!.removeEntry!()) {\n        this._params = undefined;\n      }\n    } finally {\n      this._submitting = false;\n    }\n  }\n\n  private _close(): void {\n    this._params = undefined;\n  }\n\n  static get styles(): CSSResult[] {\n    return [\n      css`\n        ha-dialog {\n          --mdc-dialog-title-ink-color: var(--primary-text-color);\n          --justify-action-buttons: space-between;\n        }\n        @media only screen and (min-width: 600px) {\n          ha-dialog {\n            --mdc-dialog-min-width: 600px;\n          }\n        }\n\n        /* make dialog fullscreen on small screens */\n        @media all and (max-width: 450px), all and (max-height: 500px) {\n          ha-dialog {\n            --mdc-dialog-min-width: 100vw;\n            --mdc-dialog-max-height: 100vh;\n            --mdc-dialog-shape-radius: 0px;\n            --vertial-align-dialog: flex-end;\n          }\n        }\n        .form {\n          padding-bottom: 24px;\n          color: var(--primary-text-color);\n        }\n        .location {\n          display: flex;\n        }\n        .location > * {\n          flex-grow: 1;\n          min-width: 0;\n        }\n        .location > *:first-child {\n          margin-right: 4px;\n        }\n        .location > *:last-child {\n          margin-left: 4px;\n        }\n        ha-location-editor {\n          margin-top: 16px;\n        }\n        ha-user-picker {\n          margin-top: 16px;\n        }\n        mwc-button.warning {\n          --mdc-theme-primary: var(--google-red-500);\n        }\n        .error {\n          color: var(--google-red-500);\n        }\n        a {\n          color: var(--primary-color);\n        }\n        p {\n          color: var(--primary-text-color);\n        }\n      `,\n    ];\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"dialog-zone-detail\": DialogZoneDetail;\n  }\n}\n\ncustomElements.define(\"dialog-zone-detail\", DialogZoneDetail);\n","export const addDistanceToCoord = (\n  location: [number, number],\n  dx: number,\n  dy: number\n): [number, number] => {\n  const rEarth = 6378000;\n  const newLatitude = location[0] + (dy / rEarth) * (180 / Math.PI);\n  const newLongitude =\n    location[1] +\n    ((dx / rEarth) * (180 / Math.PI)) / Math.cos((location[0] * Math.PI) / 180);\n  return [newLatitude, newLongitude];\n};\n"],"sourceRoot":""}