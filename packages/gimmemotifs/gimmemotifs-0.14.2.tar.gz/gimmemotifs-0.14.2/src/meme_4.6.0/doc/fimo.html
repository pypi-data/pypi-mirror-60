<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>FIMO - a motif search tool</title>
    <link href="./meme-suite.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="main">
      <script src="./meme-suite-logo.js" type="text/javascript">&gt;</script>
      <img src="images/fimo_logo.png" alt="FIMO logo" />
      <p><b>Usage:</b></p>
      <p>
      <code>fimo [options] &lt;motifs&gt; &lt;database&gt;</code>
      </p>
      <p>
      <b>Description:</b>
      </p>
      <p>
      The name <code>FIMO</code> stands for "Find Individual Motif Occurences."  
      The program searches a sequence database for occurrences of known motifs,
      treating each motif independently.  
      The program uses a dynamic programming algorithm to convert log-odds scores into p-values,
      assuming a zero-order background model.
      The program reports all motif occurrences that have p-values smaller than 
      the output p-value threshold.  
      The p-value threshold can be set using the <code>--outptu-pthresh</code> option.
      The default p-value threshold is <code>1e-4</code>.
      The p-values for each motif occurence are converted to q-values following the method of
      Benjamini and Hochberg ("q-value" is defined as the minimal
      false discovery rate at which a given motif occurrence is deemed significant).
      If a motif has the <code>strand</code> feature set
      to <code>+/-</code> (rather than <code>+</code>), then
      <code>fimo</code> will search both strands for occurrences.
      </p>
      <p>
      The parameter <code>--max-stored-scores</code> sets the maximum number of motif
      occurrences that will be retained in memory.
      It defaults to 100,000.
      If the number of matches found reaches the maximum value allowed, 
      FIMO will discard 50% of the least significant matches,
      and new matches falling below the significance level of the retained matches
      will also be discarded.
      </p>
      <p>
      <code>FIMO</code> can make use of position specific priors (PSP) to improve its
      identification of true motif occurrences.
      To take advantage of PSP in FIMO you use must provide two command line options.
      The <code>--psp</code> option is  used to set the name of a 
      <a href="meme.html#MEME-PSP">MEME PSP file</a>,
      and the <code>--prior-dist</code> option is used to set the name of a file
      containing the binned distribution of priors.
      </p>

      <p><b>Input:</b></p> 
      <ul> 
      <li>
      <code>&lt;motifs&gt;</code> is a list of motifs, in 
      <a href="meme-format.html">MEME format</a>.
      </li>
      <li>
      <code>&lt;database&gt;</code> is a collection of sequences in
      <a href="fasta-format.html">FASTA</a> format. 
      </li>
      </ul>
      <p><b>Output:</b></p>
      <p>
      FIMO will create a directory, named <code>fimo_out</code> by default.
      Any existing output files in the directory will be overwritten.
      The directory will contain:
      </p>
      <ul>
      <li>
      An XML file named <code>fimo.xml</code> using the 
      <a href="http://zlab.bu.edu/~phaverty/SupplementalData/CisML">CisML</a> schema.
      </li>
      <li>
      An HTML file named <code>fimo.html</code>
      </li>
      <li>
      A plain text file named <code>fimo.text</code>
      </li>
      <li>
      A plain text file in 
      <a href="http://www.sanger.ac.uk/resources/software/gff/">GFF format</a>
      named <code>fimo.gff</code>
      </li>
      <li>
      A plain text file in 
      <a href="https://cgwb.nci.nih.gov/goldenPath/help/wiggle.html">wiggle track format</a>
      named <code>fimo.wig</code>
      </li>
      </ul>
      <p>
      The default output directory can be overridden using the <code>--o</code> or <code>--oc</code>
      options which are described below.
      </p>
      <p>
      The <code>--text</code> option will limit output to plain text sent to the standard output.
      </p>
      <p>The HTML and plain text output contain the following columns:</p>
      <ul>
        <li>The motif identifier</li>
        <li>The sequence identiifer</li>
        <li>The start position of the motif occurence</li>
        <li>The end position of the motif occurence. 
        If the start position is larger then the end position,
        the motif occurrence is on the reverse strand.
        </li>
        <li>The score for the motif occurence.
        The score is computed by by summing the appropriate entries from each column of
        the position-dependent scoring matrix that represents the motif.</li>
        <li>The p-value of the motif occurence. 
        The p-value is the
        probability of a random sequence of the same length as the motif
        matching that position of the sequence with a score at least as good.
        </li>
        <li>The q-value of the motif occurence.
        The q-value is the estimated
        false discovery rate if the occurrence is accepted as significant.
        See Storey JD, Tibshirani R. Statistical significance for genome-wide studies. 
        <i>Proc. Natl Acad. Sci. USA (2003) 100:9440â€“9445</i>
        </li>
        <li>
        The sequence matched to the motif.
        </li>
      </ul>
      <p>The HTML and plain text output is sorted by increasing p-value.</p>
      <p>
      <b>Options:</b> 
      </p>
      <ul>
      <li><code>--bgfile <i>&lt;bfile&gt;</i></code> 
    - Read background frequencies from
    <code><i>&lt;bfile&gt;</i></code>.  
    The file should be in 
    <a href="bfile-format.html">MEME background file format</a>.
    The default is to use frequencies
    embedded in the application from the non-redundant database.  If the
    argument is the keyword <code>motif-file</code>, then the frequencies
    will be taken from the motif file.
  </li>
      <li><code>--max-seq-length <code><i>&lt;max&gt;</i></code></code>
    - Set the maximum length allowed for input sequences.
    By default the maximum allowed length is 250000000.
  </li>
      <li><code>--max-stored-scores <code><i>&lt;max&gt;</i></code></code>
    - Set the maximum number of scores that will be stored.
    Precise calculation of q-values depends on having a complete list of scores.
    However, keeping a complete list of scores may exceed available memory.
    Once the number of stored scores reaches the maximum allowed, 
    the least significant 50% of scores will be dropped,
    and approximate q-values will be calculated.
    By default the maximum number of stored matches is 100,000.
  </li>
      <li><code>--motif <i>&lt;id&gt;</i></code>
    - Use only the motif identified by <code><i>&lt;id&gt;</i></code>. 
    This option may be repeated.
  </li>
      <li><code>--motif-pseudo <i>&lt;float&gt;</i></code>
    - A pseudocount to be added to each count in the motif matrix,
    after first multiplying by the corresponding background frequency (default=0.1).
  </li>
      <li><code>--no-qvalue</code>
    - Do not compute a q-value for each p-value.  The q-value 
    calculation is that of Benjamini and Hochberg (1995).
    By default, q-values are computed.
  </li>
      <li><code>--norc</code>
    - Do not score the reverse complement DNA strand.  Both
	strands are scored by default.
  </li>
      <li><code>--o <i>&lt;dir name&gt;</i></code>
    - Specifies the output directory.
    If the directory already exists, the contents will not be overwritten.
  </li>
      <li><code>--oc <i>&lt;dir name&gt;</i></code>
    - Specifies the output directory.
    If the directory already exists, the contents will be overwritten.
  </li>
      <li><code>--output-pthresh <i>&lt;float&gt;</i></code>
    - The p-value threshold for displaying search results.
    If the p-value of a match is greater than this value,
    then the match will not be printed. 
    Using the <code>--output-pthresh</code> 
    option will set the q-value threshold to 1.0.
    The default p-value threshold is 1e-4.
  </li>
      <li><code>--output-qthresh <i>&lt;float&gt;</i></code>
    - The q-value threshold for displaying search results.
    If the q-value of a match is greater than this value,
    then the match will not be printed.
    Using the <code>--output-qthresh</code> 
    option will set the p-value threshold to 1.0.
    The default q-value threshold is 1.0.
  </li>
      <li><code>--psp <i>&lt;file&gt;</i></code>
    - File containing position specific priors (PSP) in
    <a href="meme.html#MEME-PSP">MEME PSP format</a>.
  </li>
      <li><code>--prior-dist <i>&lt;file&gt;</i></code>
    - File containing binned distribution of priors.
    This file can be generated from a 
    <a href="meme.html#MEME-PSP">MEME PSP format file</a>.
    using the
    <a href="compute-prior-dist.html">compute-prior-dist</a> utility.
  </li>
      <li><code>--text</code>
    Limits output to plain text sent to standard out.  For FIMO, the
    text output is unsorted, and q-values are not reported.  This mode
    allows the program to search an arbitrarily large database,
    because results are not stored in memory.
  </li>
      <li><code>--verbosity 1|2|3|4</code>
    - Set the verbosity of status reports to standard error.
    The default level is 2.
  </li>
      </ul>
    </div>
  </body>
</html>
